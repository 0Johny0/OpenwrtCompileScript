#!/bin/sh /etc/rc.common
# Copyright (C) 2017 lean <coolsnowwolf@gmail.com>

START=99

start() {
	
	if [ -e /usr/share/JD_Script ];then
		echo "JD_Script已存在"
	else
		git clone https://github.com/ITdesk01/JD_Script.git /usr/share/JD_Script && Detect
		chmod +x /usr/share/JD_Script/jd.sh 
		sh /usr/share/JD_Script/jd.sh system_variable
		sh /usr/share/JD_Script/jd.sh update &
	fi

	if [ -e /usr/share/Checkjs ];then
		echo "Checkjs已存在"
	else
		git clone https://github.com/ITdesk01/Checkjs.git /usr/share/Checkjs && Detect
		chmod +x /usr/share/Checkjs/checkjs.sh
		sh /usr/share/Checkjs/checkjs.sh system_variable 
	fi
	
	if [ -e /usr/share/AUCloudflareIP ];then
		echo "AUCloudflareIP已存在"
	else
		git clone https://github.com/ITdesk01/AUCloudflareIP.git /usr/share/AUCloudflareIP && Detect
		chmod +x /usr/share/AUCloudflareIP/AUCloudflareIP.sh
		chmod +x /usr/share/AUCloudflareIP/CloudflareST
		sh /usr/share/AUCloudflareIP/AUCloudflareIP.sh system_variable
	fi
	
	npm install -g crypto-js got http-server tough-cookie download request tunnel >/tmp/npm_install.log &
	exit 0
}


Detect() {
	if [ $? -eq 0 ]; then
		echo  ""
	else
		echo "代码运行失败重新执行"
		start
	fi
}
